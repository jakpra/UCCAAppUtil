# Utility scripts for UCCAApp

This repository contains a few scripts for creating and downloading user tasks from UCCAApp, formatting them for use in spreadsheets or creating confusion matrices, and sampling and splitting text into passages for upload to UCCAApp.

## Standard workflows

### Download annotation tasks and create spreadsheet

* Clone UCCA API repository and add it to PYTHONPATH
```
API_PATH=/enter/some/path
git clone https://github.com/danielhers/ucca $API_PATH
export PYTHONPATH="$PYTHONPATH:$API_PATH"
```

* Create file containing task ids for all relevant tasks (may span multiple annotators), one id per line.
```
echo -e "1223\n1279" > sample_tasks.txt
cat sample_tasks.txt
```

* Download tasks from UCCAApp (prints a JSON object per task; pipe to file).
```
python get_tasks.py -f sample_tasks.txt YourUCCAAppUsername YourUCCAAppPassword > sample_tasks.json
```

* Bring JSON objects into spreadsheet-able format.
```
python tabulate.py sample_tasks.json lex > sample_tasks.tsv
head -n3 sample_tasks.tsv
```
```
		Jakob				plurality vote		majority vote		adjudication		comments	agreement		context
		scene		function		scene	function	scene	function	scene	function		scene	function
89026	to	ComparisonRef		Goal		ComparisonRef	Goal	ComparisonRef	Goal				1.0	1.0	     It is hard to find ... and the mexican food is bland , almost equivalent |to| eating out of a can .   I would appreciate reviews from anyone who has worked with me before in

```
* Import .tsv file into a spreadsheet.

## Contents

* get_sentences.py: Script for fetching sentences from a corpus, according to a list of sentence IDs (contained in a file, one ID per line). Use -v to invert.
  * usage: python get_sentences.py CORPUS SENTENCE_IDs
* get_tasks.py: Download user tasks from UCCAApp according to a list of task IDs (either as a space-separated list with --ids, or as a file, one ID per line, with --file). Outputs retrieved tasks in JSON format, which can be further processed using  tabulate.py.
  * usage: get_tasks.py \[-h\] \[-i IDS\] \[-f FILE\] username password
* helpers.py: Collection of helper functions.
* sample.py: (Randomly) sample sentences from STREUSLE corpus, w.r.t. either type balance (as many different preposition types as possible), or unit density (as many prepositions as possible). The CORPUS file has to have PSS unit identification as generated by identify.py from the streusle github repo.
  * usage: python sample.py CORPUS FORMAT OUTPUT_FILE \[many\] MAX_SENTS
* split_passages.py:
* streusle2ucca.py: 
* tabulate.py: Convert UCCAApp user tasks (as retrieved by get_tasks.py) from JSON format into human-readable table format (use 'lex' flag) and/or creates confusion matrices and calculates agreement (use 'conf' flag).
  * usage: python tabulate.py TASKS \[lex\] \[conf\]
